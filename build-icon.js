const fs = require('fs');
const path = require('path');

// 创建一个简单的16x16紫色方块PNG图标
function createTrayIcon() {
  // 创建一个简单的16x16紫色PNG图标的base64数据
  const pngData = Buffer.from([
    0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, // PNG signature
    0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52, // IHDR chunk
    0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x10, // 16x16
    0x08, 0x02, 0x00, 0x00, 0x00, 0x90, 0x91, 0x68,
    0x36, 0x00, 0x00, 0x00, 0x30, 0x49, 0x44, 0x41, // IDAT chunk start
    0x54, 0x28, 0x15, 0x63, 0x60, 0x18, 0x05, 0xA3,
    0x60, 0x14, 0x8C, 0x82, 0x51, 0x30, 0x0A, 0x46,
    0xC1, 0x28, 0x18, 0x05, 0xA3, 0x60, 0x14, 0x8C,
    0x82, 0x51, 0x30, 0x0A, 0x46, 0xC1, 0x28, 0x18,
    0x05, 0xA3, 0x60, 0x14, 0x8C, 0x82, 0x51, 0x30,
    0x0A, 0x46, 0xC1, 0x28, 0x18, 0x05, 0x00, 0x00,
    0x00, 0x00, 0x49, 0x45, 0x4E, 0x44, 0xAE, 0x42,
    0x60, 0x82
  ]);
  
  // 创建一个更简单的方法：使用SVG转换
  const svgIcon = `
<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">
  <rect width="16" height="16" fill="#8b5cf6" stroke="#6d28d9" stroke-width="1"/>
</svg>`;
  
  // 保存SVG文件
  fs.writeFileSync('tray-icon.svg', svgIcon);
  
  // 创建ICO格式的简单图标数据
  const icoData = Buffer.from([
    // ICO header
    0x00, 0x00, 0x01, 0x00, 0x01, 0x00,
    // Image directory
    0x10, 0x10, 0x00, 0x00, 0x01, 0x00, 0x20, 0x00,
    0x00, 0x01, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00,
    // Bitmap data (16x16, 32-bit RGBA)
    ...Array(16 * 16 * 4).fill(0).map((_, i) => {
      const pixel = Math.floor(i / 4);
      const component = i % 4;
      if (component === 0) return 0xf6; // B
      if (component === 1) return 0x5c; // G  
      if (component === 2) return 0x8b; // R
      return 0xff; // A
    })
  ]);
  
  fs.writeFileSync('tray-icon.ico', icoData);
  console.log('托盘图标已创建');
}

createTrayIcon();